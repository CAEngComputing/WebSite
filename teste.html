<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Pagamento</title>
    <script src="https://sdk.mercadopago.com/js/v2"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0;
        }
        .container {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            font-size: 24px;
            margin-bottom: 20px;
        }
        .product {
            margin-bottom: 20px;
        }
        .price {
            font-size: 18px;
            color: #333;
            margin-bottom: 10px;
        }
        #wallet_container {
            margin-top: 20px;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Teste de Pagamento</h1>
    <div class="product">
        <h2>Produto de Teste</h2>
        <p class="price">Preço: R$ 75,76</p>
    </div>
    <div id="wallet_container"></div>
</div>

<script>
    // Configura o SDK do Mercado Pago
    const mp = new MercadoPago('APP_USR-694388d5-4ce6-4006-8de2-2b58d53fcd48', {
        locale: 'pt-BR'
    });

    // Função para criar a preferência de pagamento
    async function createPreference() {
        const preference = {
            items: [
                {
                    id: "item-ID-1234",
                    title: "Produto de Teste",
                    currency_id: "BRL",
                    picture_url: "https://www.mercadopago.com/org-img/MP3/home/logomp3.gif",
                    description: "Descrição do Produto de Teste",
                    category_id: "art",
                    quantity: 1,
                    unit_price: 75.76
                }
            ],
            payer: {
                name: "João",
                surname: "Silva",
                email: "user@email.com",
                phone: {
                    area_code: "11",
                    number: "4444-4444"
                },
                identification: {
                    type: "CPF",
                    number: "19119119100"
                },
                address: {
                    street_name: "Street",
                    street_number: 123,
                    zip_code: "06233200"
                }
            },
            back_urls: {
                success: "https://www.success.com",
                failure: "http://www.failure.com",
                pending: "http://www.pending.com"
            },
            auto_return: "approved",
            notification_url: "https://www.your-site.com/ipn",
            statement_descriptor: "MEUNEGOCIO",
            external_reference: "Reference_1234",
            expires: true,
            expiration_date_from: "2016-02-01T12:00:00.000-04:00",
            expiration_date_to: "2016-02-28T12:00:00.000-04:00"
        };

        try {
            const response = await fetch('https://api.mercadopago.com/checkout/preferences', {
                method: 'POST',
                headers: {
                    'Authorization': 'APP_USR-1774256113553845-080816-fb4dc18c2e3a3155031158ecb0f455fd-205112629',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(preference)
            });
            const data = await response.json();
            console.log(data);

            // Utilize o ID da preferência para iniciar o checkout
            initCheckout(data.id);
        } catch (error) {
            console.error('Error creating preference:', error);
        }
    }

    // Função para iniciar o checkout com o ID da preferência
    function initCheckout(preferenceId) {
        mp.bricks().create("wallet", "wallet_container", {
            initialization: {
                preferenceId: preferenceId,
            },
        });
    }

    document.addEventListener('DOMContentLoaded', function() {
        // Chama a função para criar a preferência e iniciar o checkout quando a página carregar
        createPreference();
    });
</script>

</body>
</html>
